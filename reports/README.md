# Разработка плана реагирования на инциденты безопасности для веб-сервера

## Этапы разработки плана реагирования

### 1. Выявление возможных угроз безопасности и уязвимостей веб-сервера

### 2. Анализ выявленных угроз и уязвимостей, методы атак и их обнаружение

### 3. Анализ способов защиты

### 4. Профилактика инцидентов

### 5. Структурирование полученных данных и их документирование

### 6. Составление плана реагирования на инциденты безопасности для веб-сервера

## Выявление возможных угроз безопасности и уязвимостей веб-сервера

Для выявления возможных угроз безопасности и уязвимостей веб-сервера рассмотрим самые частовстречаемые угрозы и уязвимости.

Подобную информацию можно найти в открытых источниках, например - OWASP Top 10, в которую включены 10 самых распространённых угроз безопасности веб-приложениям.

### OWASP Top 10 по состоянию на 2021 год

![OWASP Top 10](/src/images/owasp_top_ten.png)

Поговорим об этих угрозах поподробнее.

### A01. Broken Access Control

Нарушенный контроль доступа.

Контроль доступа обеспечивает соблюдение политики таким образом, что пользователи не могут действовать за пределами своих полномочий. Сбои обычно приводят к несанкционированному раскрытию информации, изменению или уничтожению всех данных или выполнению бизнес-функций за пределами полномочий пользователя. К распространённым уязвимостям контроля доступа относятся:

- Нарушение принципа наименьших привилегий или запрета по умолчанию, когда доступ должен предоставляться только для определённых возможностей, ролей или пользователей, но доступен всем.

- Обход проверок контроля доступа путём изменения URL-адреса (подмена параметров или принудительный просмотр), внутреннего состояния приложения или HTML-страницы, а также с помощью инструмента для атак, изменяющего запросы API.

- Разрешение на просмотр или редактирование чужой учётной записи путём предоставления её уникального идентификатора (незащищённые прямые ссылки на объекты)

- Доступ к API с отсутствующими элементами управления доступом для ПУБЛИКАЦИИ, РАЗМЕЩЕНИЯ и УДАЛЕНИЯ.

- Повышение привилегий. Работа в качестве пользователя без входа в систему или в качестве администратора при входе в систему в качестве пользователя.

- Манипуляции с метаданными, такие как воспроизведение или изменение токена управления доступом JSON Web Token (JWT), а также манипулирование файлами cookie или скрытыми полями для повышения привилегий или злоупотребления при аннулировании JWT.

- Неправильная настройка CORS позволяет получить доступ к API из неавторизованных/ненадёжных источников.

- Принудительно переходить на аутентифицированные страницы в качестве неаутентифицированного пользователя или на привилегированные страницы в качестве стандартного пользователя.

### A02. Cryptographic Failures

Криптографические сбои

Прежде всего необходимо определить, какая защита требуется для данных при передаче и хранении. Например, пароли, номера кредитных карт, медицинские записи, личная информация и коммерческая тайна требуют дополнительной защиты, особенно если эти данные подпадают под действие законов о конфиденциальности, например Общего регламента ЕС по защите данных (GDPR), или нормативных актов, например Стандарта безопасности данных PCI (PCI DSS). Для всех таких данных:

- Передаются ли какие-либо данные в открытом виде? Это касается таких протоколов, как HTTP, SMTP, FTP, а также обновлений TLS, таких как STARTTLS. Внешний интернет-трафик опасен. Проверьте весь внутренний трафик, например, между балансировщиками нагрузки, веб-серверами или серверными системами.

- Используются ли какие-либо старые или слабые криптографические алгоритмы или протоколы по умолчанию или в устаревшем коде?

- Используются ли криптографические ключи по умолчанию, генерируются ли или повторно используются слабые криптографические ключи, отсутствует ли надлежащее управление ключами или их ротация? Проверяются ли криптографические ключи в репозиториях исходного кода?

- Не применяется ли шифрование, например, отсутствуют ли какие-либо директивы безопасности в HTTP-заголовках (браузера) или заголовках?

- Правильно ли проверен полученный сертификат сервера и цепочка доверия?

- Являются ли векторы инициализации игнорируемыми, повторно используемыми или недостаточно безопасными для криптографического режима работы? Используется ли небезопасный режим работы, такой как ECB? Используется ли шифрование, когда более подходящим является аутентифицированное шифрование?

- Используются ли пароли в качестве криптографических ключей при отсутствии функции получения ключа на основе пароля?

- Используется ли случайность в криптографических целях, если она не соответствует криптографическим требованиям? Даже если выбрана правильная функция, нужно ли разработчику задавать начальное значение, и если нет, то не перезаписал ли разработчик встроенную функцию сильного начального значения начальным значением, которому не хватает энтропии/непредсказуемости?

- Используются ли устаревшие хеш-функции, такие как MD5 или SHA1, или некриптографические хеш-функции используются, когда нужны криптографические хеш-функции?

- Используются ли устаревшие методы криптографического заполнения, такие как PKCS номер 1 версии 1.5?

- Можно ли использовать сообщения об ошибках в криптографии или информацию о побочных каналах, например, в виде атак с использованием заполнителя?

### A03. Injection

Инъекция

Приложение уязвимо для атаки, когда:

- Приложение не проверяет, не фильтрует и не очищает данные, предоставленные пользователем.

- Динамические запросы или непараметризованные вызовы без учёта контекста используются непосредственно в интерпретаторе.

- В параметрах поиска объектно-реляционного отображения (ORM) используются вредоносные данные для извлечения дополнительных конфиденциальных записей.

- Вредные данные используются напрямую или объединяются. SQL-запрос или команда содержат структуру и вредоносные данные в динамических запросах, командах или хранимых процедурах.

Некоторые из наиболее распространённых инъекций — это SQL, NoSQL, команды ОС, объектно-реляционное отображение (ORM), LDAP и внедрение языка выражений (EL) или библиотеки навигации по графу объектов (OGNL). Концепция одинакова для всех интерпретаторов. Проверка исходного кода — лучший способ определить, уязвимы ли приложения для инъекций. Настоятельно рекомендуется проводить автоматизированное тестирование всех параметров, заголовков, URL, файлов cookie, JSON, SOAP и XML. Организации могут включить инструменты статического (SAST), динамического (DAST) и интерактивного (IAST) тестирования безопасности приложений в конвейер CI/CD, чтобы выявлять уязвимости, связанные с внедрением кода, до выпуска в рабочую среду.

### A04. Broken Access Control

### A05. Broken Access Control

### A06. Broken Access Control

### A07. Broken Access Control

### A08. Broken Access Control

### A09. Broken Access Control

### A10. Broken Access Control

